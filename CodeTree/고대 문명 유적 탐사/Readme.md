수천 년 동안 잊혀진 고대 문명의 유적을 발견하게 되었습니다. 이 유적지는 5×5 격자 형태로 되어 있으며, 각 칸에는 다양한 유물의 조각이 배치되어 있습니다. 유물 조각은 총 7가지 종류로, 각각 숫자 1부터 7로 표현됩니다.

[1] 탐사 진행
3×3 격자 선택
당신은 고고학자로서 5×5 격자 내에서 3×3 격자를 선택하여 격자를 회전시킬 수 있습니다. 선택된 격자는 시계 방향으로 90도, 180도, 270도 중 하나의 각도만큼 회전시킬 수 있습니다. 단, 선택된 격자는 항상 회전을 진행해야만 합니다.

예를 들어, 다음과 같이 유적지가 존재한다고 가정해보겠습니다.




만약 회전 중심 좌표를 (3,3)으로 설정하고, 90도 회전하면 유적지는 다음과 같이 바뀌게 됩니다.



회전 목표
가능한 회전의 방법 중 (1) 유물 1차 획득 가치를 최대화하고, 그러한 방법이 여러가지인 경우 (2) 회전한 각도가 가장 작은 방법을 선택합니다. 그러한 경우도 여러가지인 경우 (3) 회전 중심 좌표의 열이 가장 작은 구간을, 그리고 열이 같다면 행이 가장 작은 구간을 선택합니다.

[2] 유물 획득
유물 1차 획득
상하좌우로 인접한 같은 종류의 유물 조각은 서로 연결되어 있습니다. 이 조각들이 3개 이상 연결된 경우, 조각이 모여 유물이 되고 사라집니다. 유물의 가치는 모인 조각의 개수와 같습니다.

예를 들어, 아래와 같이 유적지가 존재한다면 유물은 총 7개의 조각으로 이루어지게 됩니다.




각각 3개, 4개의 조각이 모이므로 얻게 되는 유물의 가치는 총 7이 됩니다.

이 유적지에서 유물이 사라지고 난 이후의 모습은 다음과 같습니다.




유적의 벽면에는 1부터 7 사이의 숫자가 M개 적혀 있습니다. 이들은 유적에서 조각이 사라졌을 때 새로 생겨나는 조각에 대한 정보를 담고 있습니다.

예를 들어, 유적의 벽면에 아래와 같이 새로 생겨나는 조각에 대한 정보는 아래와 같습니다.




조각이 사라진 위치에는 유적의 벽면에 적혀있는 순서대로 새로운 조각이 생겨납니다. 새로운 조각은 (1) 열 번호가 작은 순으로 조각이 생겨납니다. 만약 열 번호가 같다면 (2) 행 번호가 큰 순으로 조각이 생겨납니다. 단, 벽면의 숫자는 충분히 많이 적혀 있어 생겨날 조각의 수가 부족한 경우는 없다고 가정해도 좋습니다.

위의 예시에서 새로운 조각들이 채워지는 방법에 따른 순서를 나타내면 다음과 같습니다.




따라서 조각은 아래와 같이 채워집니다.




단, 유적의 벽면에 써 있는 숫자를 사용한 이후에는 다시 사용할 수 없으므로 이후 부터는 남은 숫자부터 순서대로 사용합니다. 즉, 이후에는 아래 그림에서 8번째로 적혀있는 수인 1부터 다시 사용이 가능합니다.




유물 연쇄 획득
새로운 유물 조각이 생겨난 이후에도 조각들이 3개 이상 연결될 수 있습니다. 이 경우 앞과 같은 방식으로 조각이 모여 유물이 되고 사라집니다. 사라진 위치에는 또다시 새로운 조각이 생겨나며 이는 더 이상 조각이 3개 이상 연결되지 않아 유물이 될 수 없을 때까지 반복됩니다.

위의 예시에서는 새로운 유물 조각이 생겨난 이후에도 다음과 같이 유물이 만들어집니다. 따라서 연쇄적으로 유물을 획득하는 과정을 반복해야 합니다.




[3] 탐사 반복
이 문제에서는 탐사 진행 ~ 유물 연쇄 획득의 과정까지를 1턴으로 생각하며, 총 K 번의 턴에 걸쳐 진행됩니다.

각 턴마다 획득한 유물의 가치의 총합을 출력하는 프로그램을 작성해야 합니다. 단, 아직 K번의 턴을 진행하지 못했지만, 탐사 진행 과정에서 어떠한 방법을 사용하더라도 유물을 획득할 수 없었다면 모든 탐사는 그 즉시 종료됩니다. 이 경우 얻을 수 있는 유물이 존재하지 않음으로, 종료되는 턴에 아무 값도 출력하지 않음에 유의합니다.

입력 형식
첫 번째 줄에 탐사의 반복 횟수 K와 벽면에 적힌 유물 조각의 개수 M이 공백을 사이에 두고 주어집니다.

그 다음 5개의 줄에 걸쳐 유물의 각 행에 있는 유물 조각에 적혀 있는 숫자들이 공백을 사이에 두고 순서대로 주어집니다.

그 다음 줄에는 벽면에 적힌 M개의 유물 조각 번호가 공백을 사이에 두고 순서대로 주어집니다.

단, 초기에 주어지는 유적지에서는 탐사 진행 이전에 유물이 발견되지 않으며, 첫 번째 턴에서 탐사를 진행한 이후에는 항상 유물이 발견됨을 가정해도 좋습니다.

1≤K≤10
10≤M≤300
1≤ 유물 조각 번호 ≤7
출력 형식
첫 번째 줄에 각 턴 마다 획득한 유물의 가치의 총합을 공백을 사이에 두고 출력합니다.

입출력 예제
예제1
입력:

2 20
7 6 7 6 7
6 7 6 7 6
6 7 1 5 4
7 6 3 2 1
5 4 3 2 7
3 2 3 5 2 4 6 1 3 2 5 6 2 1 5 6 7 1 2 3
출력:

17
예제2
입력:

2 30
7 6 7 6 7
6 7 6 7 6
6 7 1 5 4
7 6 3 2 1
5 4 3 2 7
3 2 3 5 2 4 6 1 3 2 5 6 2 1 6 6 7 5 4 2 2 3 1 3 1 2 4 2 1 3
출력:

17 3
예제 설명
1번 예제에서 처음 유적지는 다음과 같이 존재합니다.




만약 회전 중심 좌표를 (3,3)으로 설정하고, 90도 회전하면 유적지는 다음과 같이 바뀌게 됩니다.



만약 회전 중심 좌표를 (2,3)으로 설정하고, 180도 회전하면 유적지는 다음과 같이 바뀌게 됩니다.




각각의 경우 다음과 같이 유물이 생성됩니다.




두 경우 모두 유물 획득 가치가 7로 가장 크지만, 우선순위 규칙에 따라 회전한 각도가 더 작은 (3,3)의 방법이 선택됩니다.

따라서 (3,3)의 방법대로 탐사를 진행하고 유물 조각이 사라지고 난 후의 모습은 다음과 같습니다.




유적의 벽면에 써 있는 숫자에 따라 새로운 조각들이 채워지는 방법에 따른 순서를 나타내면 다음과 같습니다.




따라서 조각은 다음과 같이 채워집니다.




새로운 유물 조각이 생겨난 이후에도 유물이 존재하기 때문에 유물 연쇄 획득 과정을 진행해야 합니다. 이어서 생기는 유물은 다음과 같습니다.




유물 조각이 사라지고 난 후, 새로 생겨나는 조각들은 다음과 같은 방법으로 채워집니다.




따라서 조각은 다음과 같이 채워집니다.




다음으로 생기는 유물은 아래와 같습니다.




유물 조각이 사라지고 난 후, 새로 생겨나는 조각들은 다음과 같은 방법으로 채워집니다.




따라서 조각은 다음과 같이 채워집니다.




더 이상 유물이 발견되지 않으므로 이 과정을 끝으로 첫 번째 턴이 마무리 되며, 첫 번째 턴에서 얻은 유물 가치의 총 합인 17(=7 + 7 + 3)이 출력됩니다. 두 번째 턴에서는 탐사 진행 과정에서 어떠한 방법을 사용하더라도 유물을 획득할 수 없기 때문에 탐사가 즉시 종료됩니다.
